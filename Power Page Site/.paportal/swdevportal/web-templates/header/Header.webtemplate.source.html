<style>
    .quick-access {
        position: sticky;
        top: 106.5px;
        border-bottom: 1px solid #e7e7e7;
        background-color: #fff;
        z-index: 999;
    }
    .quick-access nav > a {
        padding: 1.05rem 0;
        border-bottom: 3px solid transparent;
        transition: all .35s ease;
        color: #000;
        font-size: 1.015rem;
    }
    .quick-access nav > a:hover,
    .quick-access nav > a.is-active {
        color: orangered;
        border-bottom-color: orangered;
    }
    .quick-access nav{
        gap: 3.15rem;
    }
    div.sortoption {
        display: none !important;
    }
    .search-results li>.title, .search-results li>h3 > a {
        font-size: 1.35rem;
    }
    .search-results li>.title, .search-results li > h3 ~ p {
        padding-bottom: 1rem;
        font-size: 1.015rem;
    }
    .js-facet-order-definition.hidden {
        display: none;
    }

    .pagination > .active > span {
        border: none !important;
    }
    .contact-tooltip {
        box-shadow: 0 3px 20px rgba(0, 0, 0, .16), 0 3px 20px rgba(0, 0, 0, 0);
        z-index: 8 !important;
        background-color: white;
        left: 50%;
        width: 650px;
        transform: translateX(-50%);
    }

    .contact-tooltip.active {
        overflow: visible;
        top: 3rem;
        margin-top: -.5rem;
    }
    .contact-tooltip h3,
    .contact-tooltip p {
        font-size: 1.125rem !important;
        line-height: 1.375rem;
    }
    .contact-tooltip h3{
        min-height: 70px;
    }
    .contact-tooltip:before {
    content: "";
    width: 0;
    height: 0;
    border-left: 10px solid rgba(0, 0, 0, 0);
    border-right: 10px solid rgba(0, 0, 0, 0);
    border-bottom: 10px solid #fff;
    left: 50%;
    transform: translateX(-50%);
    position: absolute;
    z-index: 1;
    top: -10px;
}

.btn.btn__orange_ghost {
    color: #ed573c;
    background-color: rgba(0, 0, 0, 0);
    border: .0625rem solid #ed573c;
    display: flex;
    gap: 1rem;
}
.btn.small {
    padding: .75rem 1.25rem;
    font-size: .875rem;
    line-height: 1.125rem;
}
</style>
{% assign defaultlang = settings['LanguageLocale/Code'] | default: 'en-us' %}
{% assign homeurl = website.adx_partialurl %}
<div class=" navbar-expand-xl navbar navbar-dark static-top" style="flex-wrap:wrap;" role="banner">
    <div class="skip-to-content"><a href="#mainContent">{{ resx.Skip_To_Content | default: "Skip to main content" }}</a></div><div class="container custom-container">

        <!--
          div class=" ">
            {% editable snippets "Mobile Header" type: "html" %}
          </div
        -->
        <div class="navbar-brand navbar-header">
             {% editable snippets 'Mobile Header' type: 'html' %}
        </div>
        <button type="button" class="navbar-toggler collapsed custom-navbar-toggler" title="{{ snippets["Header/Toggle Navigation"] | default: resx['Toggle_Navigation'] | h }}" data-bs-toggle="collapse" data-bs-target="#navbar" aria-expanded="false" onclick="setHeight();">
            <span class="visually-hidden">{{ snippets["Header/Toggle Navigation"] | default: resx['Toggle_Navigation'] | h }}</span>
            <span class="navbar-toggler-icon"></span>
        </button>

        <div id="navbar" class="navbar-collapse collapse" style="width: min-content;">
            {% assign primary_nav = weblinks["Default"] %}
            {% if primary_nav %}
            <nav aria-label="{{ resx.Main_Navigation | default: "Main Navigation" }}" class="ms-auto menu-bar {% if primary_nav.editable %}xrm-entity xrm-editable-adx_weblinkset{% endif %}" data-weblinks-maxdepth="2">
                <ul class="nav navbar-nav weblinks">
                    {% for link in primary_nav.weblinks %}
                    {% unless forloop.first %}
                    <li class="nav-item divider-vertical" aria-hidden="true"></li>
                    {% endunless %}
                    {% if link.display_page_child_links %}
                    {% if link.url != null %}
                    {% assign sublinks = sitemap[link.url].children %}
                    {% endif %}
                    {% else %}
                    {% assign sublinks = link.weblinks %}
                    {% endif %}
                    <li class=" nav-item weblink {% if sublinks.size > 0 %} dropdown{% endif %}">
                        <a aria-label="{{ link.name | escape }}" {% if sublinks.size > 0 -%} href="#" role="button" class="dropdown-toggle nav-link" data-bs-toggle="dropdown" {%- else -%} href="{{ link.url | escape }}" aria-roledescription="link" class="nav-link" {%- endif -%} {%- if link.Open_In_New_Window %} target="_blank" {% endif -%} {%- if link.nofollow %} rel="nofollow" {% endif -%} {%- if link.tooltip %} title="{{ link.tooltip | escape }}" {% endif %}>
                            {%- if link.image -%}
                            {%- if link.image.url  -%}
                            {%- if link.image.url.first == '.' -%}
                            <span class="{{ link.image.url | split:'.' | join }}" aria-hidden="true"></span>
                            {%- endif -%}
                            {%- else -%}
                            <img src="{{ link.image.url | escape }}" alt="{{ link.image.alternate_text | default:link.tooltip | escape }}" {% if link.image.width %}width="{{ link.image.width | escape }}" {% endif %} {% if link.image.height %}height="{{ link.image.height | escape }}" {% endif %} />
                            {%- endif -%}
                            {%- endif -%}
                            {%- unless link.display_image_only -%}
                            {{ link.name | escape }}
                            {%- endunless -%}
                        </a>
                        {% if sublinks.size > 0 %}
                        <ul class="dropdown-menu">
                            {% if link.name %}
                            <li>
                                <a class="dropdown-item" aria-label="{{ link.name | escape }}" aria-roledescription="link" href="{{ link.url }}" {% if link.Open_In_New_Window %} target="_blank" {% endif %} {% if link.nofollow %}rel="nofollow" {% endif %} {% if link.tooltip %}title="{{ link.tooltip | escape }}" {% endif %}>{{ link.name | escape }}</a>
                            </li>
                            <div class="dropdown-divider"></div>
                            {% endif %}
                            {% for sublink in sublinks %}
                            <li>
                                <a class="dropdown-item" aria-label="{{ sublink.name | default:sublink.title | escape }}" aria-roledescription="link" href="{{ sublink.url }}" {% if sublink.Open_In_New_Window %} target="_blank" {% endif %} {% if sublink.nofollow %}rel="nofollow" {% endif %} {% if sublink.tooltip %}title="{{ sublink.tooltip | escape }}" {% endif %}>
                                    {{ sublink.name | default:sublink.title | escape }}
                                </a>
                            </li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                    </li>
                    {% endfor %}
                    {% assign search_enabled = settings['Search/Enabled'] | boolean | default:true %}
                    {% if search_enabled %}
                    <li class=" nav-item divider-vertical" aria-hidden="true"></li>
                    <li class=" nav-item dropdown">
                        <a id="search" class=" nav-link navbar-icon" href="#" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-label="{{ snippets["Header/Search/ToolTip"] | default:resx["Search_DefaultText"] | escape }}">
                            <span class="glyphicon fa-solid fa-magnifying-glass"></span>
                        </a>
                        <div class="dropdown-menu dropdown-search">
                            {% include 'Search', search_id:'q' %}
                        </div>
                    </li>
                    {% endif %}

                    {% if website.languages.size > 1 %}
                    <li class=" nav-item divider-vertical" aria-hidden="true"></li>
                    <li class=" nav-item dropdown">
                        <a class=" nav-link dropdown-toggle" aria-roledescription="link" href="#" data-bs-toggle="dropdown" aria-label="{{ website.selected_language.name | escape }}" aria-haspopup="true" aria-expanded="false" title="{{ website.selected_language.name | escape }}">
                            <span class="drop_language">{{ website.selected_language.name | escape }}</span>
                        </a>
                        {% include 'Languages Dropdown' %}
                    </li>
                    {% endif %}

                    {% assign profile_enabled = settings['Profile/Enabled'] | boolean | default: true %}
                    {% if profile_enabled %}
                    <li class=" nav-item divider-vertical" aria-hidden="true"></li>
                    {% if user %}
                    <li class=" nav-item dropdown">
                        {% assign username = user.fullname | escape %}
                        <a href="#" class=" nav-link dropdown-toggle" aria-roledescription="link" title="{{username | default: resx["Default_Profile_name"] }}" data-bs-toggle="dropdown" role="button" aria-expanded="false">
                            <span class="username">{{ username | default: resx['Default_Profile_name'] }}</span>
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            {% assign show_profile_nav = settings["Header/ShowAllProfileNavigationLinks"] | boolean | default: true %}
                            {% if show_profile_nav %}
                            {% assign profile_nav = weblinks["Profile Navigation"] %}
                            {% if profile_nav %}
                            {% for link in profile_nav.weblinks %}
                            <li>
                                <a class="dropdown-item" aria-label="{{ link.name | escape }}" aria-roledescription="link" href="{{ link.url | escape }}" title="{{ link.name | escape }}">{{ link.name | escape }}</a>
                            </li>
                            {% endfor %}
                            {% endif %}
                            {% else %}
                            <li><a class="dropdown-item" aria-label="{{ snippets["Profile Link Text"] | default:resx["Profile_Text"] | escape }}" aria-roledescription="link" href="{{ sitemarkers['Profile'].url | escape }}">{{ snippets["Profile Link Text"] | default: resx["Profile_Text"] | escape }}</a></li>
                            {% endif %}
                            <li class="dropdown-divider" role="separator" aria-hidden="true"></li>
                            <li>
                                <a class="dropdown-item" aria-label="{{ snippets["links/logout"] | default:resx["Sign_Out"] | escape }}" aria-roledescription="link" href="{% if homeurl%}/{{ homeurl }}{% endif %}{{ website.sign_out_url_substitution }}" title="{{ snippets["links/logout"] | default:resx["Sign_Out"] | escape }}">
                                    {{ snippets["links/logout"] | default:resx["Sign_Out"] | escape }}
                                </a>
                            </li>
                        </ul>
                    </li>
                    {% else %}
                    <li class="nav-item">
                        <a class="nav-link" aria-label="{{ snippets["links/login"] | default:resx["Sign_In"] | escape }}" aria-roledescription="link" href="{% if homeurl%}/{{ homeurl }}{% endif %}{{ website.sign_in_url_substitution }}">
                            {{ snippets["links/login"] | default:resx["Sign_In"] | escape }}
                        </a>
                    </li>
                    {% endif %}
                    {% endif %}
                </ul>
                {% editable primary_nav %}
            </nav>
            {% endif %}
        </div>
    </div>
</div>

{% if user %}
 
<div class="quick-access" data-test="{{ website.selected_language.name | downcase | escape  }}" data-test-code="{{ website.selected_language.code | downcase | escape  }}">                     
    <div class="container custom-container">
        <nav class="d-flex align-items-center">
            {% assign locale = website.selected_language.code | downcase %}
            {% if locale == "fr-fr" %}
                <a href="/fr-FR">Accueil</a>
                <a href="/fr-FR/knowledge-base" class="">Base de connaissances</a>
                <a href="/fr-FR/tickets/" class="">Créer une demande</a>
                <a href="/fr-FR/tickets/my-tickets/" class="">Voir les demandes actives</a>
                <a href="https://status.sherweb.com/?lang=fr">État du réseau</a>
                {% include 'Chat Widget - FR' %}
            {% else %}
            <a href="/">Home</a>
            <a href="/knowledge-base" class="">Knowledge Base</a>
            <a href="/tickets/" class="">Open a new request</a>
            <a href="/tickets/my-tickets/" class="">View active requests</a>
            <a href="https://status.sherweb.com">Network Status</a>
            {% include 'Chat Widget - EN' %}
        {%endif%}

        </nav>
    </div>
</div>
 
{% else %}
 
<div class="quick-access" data-test="{{ website.selected_language.name | downcase | escape  }}" data-test-code="{{ website.selected_language.code | downcase | escape  }}">                     
    <div class="container custom-container">
        <nav class="d-flex align-items-center">
            {% assign locale = website.selected_language.code | downcase %}
            {% if locale == "fr-fr" %}
                <a href="/fr-FR">Accueil</a>
                <a href="/fr-FR/knowledge-base" class="">Base de connaissances</a>
                <a href="/fr-FR/tickets/" class="">Créer une demande</a>
                <a href="https://status.sherweb.com/?lang=fr">État du réseau</a>
                {% include 'Chat Widget - FR' %}
            {% else %}
            <a href="/">Home</a>
            <a href="/knowledge-base" class="">Knowledge Base</a>
            <a href="/tickets/" class="">Open a new request</a>
            <a href="https://status.sherweb.com">Network Status</a>
            {% include 'Chat Widget - EN' %}
        {%endif%}

        </nav>
    </div>
</div>
 
{% endif %}
{% substitution %}
{% assign current_page = page.id %}
{% assign sr_page = sitemarkers["Search"].id %}
{% assign forum_page = sitemarkers["Forums"].id %}
{% if current_page %}
  {% if current_page == sr_page or current_page == forum_page %}
    {% assign section_class = "section-landing-search" %}
    {% if current_page == forum_page %}
      {% assign section_class = "section-landing-forums" %}
    {% endif %}
<section class="page_section {{ section_class | h }} color-inverse d-none">
    <div class="row sectionBlockLayout sectionFixedStyle" style="display: flex; flex-wrap: wrap; text-align: center;">
        <div class="container" style="display: flex; flex-wrap: wrap;">
            <div class="col-lg-12 columnBlockLayout" style="display: flex; flex-direction: column; justify-content: center;">
            
                {% if current_page == sr_page %}
                <h1 id="mainContent">{% editable snippets 'Search/Title' default: resx["Discover_Contoso"] %}</h1>
                {% include 'Search' search_id:'search_control' %}
                {% endif %}
            </div>
        </div>
    </div>
</section>
{% endif %}
{% endif %}
{% endsubstitution %}
<script type="text/javascript">

    document.addEventListener("DOMContentLoaded", function() {

        const ticketOptionsMenu = [].slice.call(document.querySelectorAll('.ticket-menu'));
        const triggerChatModal = [].slice.call(document.querySelectorAll('.open_support_chat'))

        const handleTicketOptionsMenu = (e) => {
            e.preventDefault()
            e.currentTarget.classList.toggle('is-active')       
        }

        const handleTriggerChatModal = (e) => {
            console.log('clicked')
            e.preventDefault()
            try {
                window.Microsoft.Omnichannel.LiveChatWidget.SDK.startChat()
            } catch (error) {
                console.error(error)
            }
        }

        ticketOptionsMenu.map(el => el.addEventListener('click', handleTicketOptionsMenu))
        triggerChatModal.map(el => el.addEventListener('click', handleTriggerChatModal))
    })

    window.onload = function() {
        if (window.navigator.appName == "Microsoft Internet Explorer" || window.navigator.userAgent.indexOf("Trident") > 0) {
            var searchElement = document.getElementById("search");
            if (searchElement != null) searchElement.setAttribute("href", "");
        }
    };
    function setHeight() {
        var windowHeight = window.innerHeight - 140;
        var navbar = document.getElementById("navbar");
        if (navbar) {
            navbar.style.maxHeight = windowHeight + "px";
        }
    }
    window.addEventListener('resize', function(event) {
        setHeight();
    });

    (function() {
        const navMenu = document.querySelector("ul.nav.navbar-nav.weblinks");
  
        if (navMenu.children.length > 0) {
            const firstItem = navMenu.children[0];
            navMenu.removeChild(firstItem);
            console.log("Removed first item:", firstItem.outerHTML);
        }
        
        if (navMenu.children.length > 0) {
            const newFirstItem = navMenu.children[0];
            navMenu.appendChild(newFirstItem);
            console.log("Moved new first item to last position:", newFirstItem.outerHTML);
        }
        
        if (navMenu.children.length > 1) {
            const newFirstItem = navMenu.children[0];
            const lastItem = navMenu.lastElementChild;
            navMenu.insertBefore(newFirstItem, lastItem);
            console.log("Moved new first item to before the last position:", newFirstItem.outerHTML);
        }
    } ())
</script>
