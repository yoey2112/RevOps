function onCumulusOrganizationChange(executionContext) {
    var formContext = executionContext.getFormContext();
    var cumulusOrgLookup = formContext.getAttribute("revops_cumulusorganization").getValue();

    if (cumulusOrgLookup && cumulusOrgLookup.length > 0) {
        var cumulusOrgId = cumulusOrgLookup[0].id.replace("{", "").replace("}", "");

        Xrm.WebApi.retrieveRecord(
            "revops_cumulusorganization",
            cumulusOrgId,
            "?$select=_revops_cumulusaccount_value&$expand=revops_cumulusaccount($select=_revops_account_value)"
        ).then(
            function (result) {
                // --- Set Cumulus Account ---
                if (result["_revops_cumulusaccount_value"]) {
                    var cumulusAccountId = result["_revops_cumulusaccount_value"];
                    var cumulusAccountName = result["_revops_cumulusaccount_value@OData.Community.Display.V1.FormattedValue"];

                    formContext.getAttribute("revops_cumulusaccount").setValue([
                        {
                            id: cumulusAccountId,
                            name: cumulusAccountName || "",
                            entityType: "revops_cumulusaccount"
                        }
                    ]);

                    // --- Set Account ---
                    if (result["revops_cumulusaccount"] && result["revops_cumulusaccount"]["_revops_account_value"]) {
                        var accountId = result["revops_cumulusaccount"]["_revops_account_value"];
                        var accountName = result["revops_cumulusaccount"]["_revops_account_value@OData.Community.Display.V1.FormattedValue"];

                        formContext.getAttribute("revops_account").setValue([
                            {
                                id: accountId,
                                name: accountName || "",
                                entityType: "account"
                            }
                        ]);
                    } else {
                        formContext.getAttribute("revops_account").setValue(null);
                    }
                } else {
                    formContext.getAttribute("revops_cumulusaccount").setValue(null);
                    formContext.getAttribute("revops_account").setValue(null);
                }
            },
            function (error) {
                console.error("Error retrieving related records: ", error.message);
            }
        );
    } else {
        formContext.getAttribute("revops_cumulusaccount").setValue(null);
        formContext.getAttribute("revops_account").setValue(null);
    }
}